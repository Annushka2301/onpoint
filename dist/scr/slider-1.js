"use strict";

var slider = document.querySelector('.slider'),
    sliderList = slider.querySelector('.slider__list'),
    sliderTrack = slider.querySelector('.slider__track'),
    slides = slider.querySelectorAll('.slider__slide'),
    home = document.querySelector('.header__btn'),
    next = slider.querySelector('.slide-1__btn'),
    slideWidth = slides[0].offsetWidth,
    slideIndex = 0,
    posInit = 0,
    posX1 = 0,
    posX2 = 0,
    posY1 = 0,
    posY2 = 0,
    posFinal = 0,
    isSwipe = false,
    isScroll = false,
    allowSwipe = true,
    transition = true,
    nextTrf = 0,
    prevTrf = 0,
    lastTrf = --slides.length * slideWidth,
    posThreshold = slides[0].offsetWidth * 0.35,
    trfRegExp = /([-0-9.]+(?=px))/,
    swipeStartTime,
    swipeEndTime,
    animation = document.querySelectorAll('.slide-2__img');
modal = document.querySelector('.modal');
getEvent = function getEvent() {
  return event.type.search('touch') !== -1 ? event.touches[0] : event;
}, slide = function slide() {
  if (transition) {
    sliderTrack.style.transition = 'transform .5s';
  }

  sliderTrack.style.transform = "translate3d(-".concat(slideIndex * slideWidth, "px, 0px, 0px)");

  if (slideIndex === 1) {
    for (var i = 0; i < animation.length; i++) {
      animation[i].classList.add('appear');
    }

    ;
  } else {
    for (var _i = 0; _i < animation.length; _i++) {
      animation[_i].classList.remove('appear');
    }

    ;
  }

  if (slideIndex !== 2) modal.style = 'display: none'; // prev.classList.toggle('disabled', slideIndex === 0);
  // next.classList.toggle('disabled', slideIndex === --slides.length);
}, swipeStart = function swipeStart() {
  var evt = getEvent();

  if (allowSwipe) {
    swipeStartTime = Date.now();
    transition = true;
    nextTrf = (slideIndex + 1) * -slideWidth;
    prevTrf = (slideIndex - 1) * -slideWidth;
    posInit = posX1 = evt.clientX;
    posY1 = evt.clientY;
    sliderTrack.style.transition = '';
    document.addEventListener('touchmove', swipeAction);
    document.addEventListener('mousemove', swipeAction);
    document.addEventListener('touchend', swipeEnd);
    document.addEventListener('mouseup', swipeEnd);
    sliderList.classList.remove('grab');
    sliderList.classList.add('grabbing');
  }
}, swipeAction = function swipeAction() {
  var evt = getEvent(),
      style = sliderTrack.style.transform,
      transform = +style.match(trfRegExp)[0];
  posX2 = posX1 - evt.clientX;
  posX1 = evt.clientX;
  posY2 = posY1 - evt.clientY;
  posY1 = evt.clientY;

  if (!isSwipe && !isScroll) {
    var posY = Math.abs(posY2);

    if (posY > 7 || posX2 === 0) {
      isScroll = true;
      allowSwipe = false;
    } else if (posY < 7) {
      isSwipe = true;
    }
  }

  if (isSwipe) {
    if (slideIndex === 0) {
      if (posInit < posX1) {
        setTransform(transform, 0);
        return;
      } else {
        allowSwipe = true;
      }
    }

    if (slideIndex === --slides.length) {
      if (posInit > posX1) {
        setTransform(transform, lastTrf);
        return;
      } else {
        allowSwipe = true;
      }
    }

    if (posInit > posX1 && transform < nextTrf || posInit < posX1 && transform > prevTrf) {
      reachEdge();
      return;
    }

    sliderTrack.style.transform = "translate3d(".concat(transform - posX2, "px, 0px, 0px)");
  }
}, swipeEnd = function (_swipeEnd) {
  function swipeEnd() {
    return _swipeEnd.apply(this, arguments);
  }

  swipeEnd.toString = function () {
    return _swipeEnd.toString();
  };

  return swipeEnd;
}(function () {
  posFinal = posInit - posX1;
  isScroll = false;
  isSwipe = false;
  document.removeEventListener('touchmove', swipeAction);
  document.removeEventListener('mousemove', swipeAction);
  document.removeEventListener('touchend', swipeEnd);
  document.removeEventListener('mouseup', swipeEnd);
  sliderList.classList.add('grab');
  sliderList.classList.remove('grabbing');

  if (allowSwipe) {
    swipeEndTime = Date.now();

    if (Math.abs(posFinal) > posThreshold || swipeEndTime - swipeStartTime < 300) {
      if (posInit < posX1) {
        slideIndex--;
      } else if (posInit > posX1) {
        slideIndex++;
      }
    } // if (slideIndex === 1)


    if (posInit !== posX1) {
      allowSwipe = false;
      slide();
    } else {
      allowSwipe = true;
    }
  } else {
    allowSwipe = true;
  }
}), setTransform = function setTransform(transform, comapreTransform) {
  if (transform >= comapreTransform) {
    if (transform > comapreTransform) {
      sliderTrack.style.transform = "translate3d(".concat(comapreTransform, "px, 0px, 0px)");
    }
  }

  allowSwipe = false;
}, reachEdge = function reachEdge() {
  transition = false;
  swipeEnd();
  allowSwipe = true;
};
sliderTrack.style.transform = 'translate3d(0px, 0px, 0px)';
sliderList.classList.add('grab');
sliderTrack.addEventListener('transitionend', function () {
  return allowSwipe = true;
});
slider.addEventListener('touchstart', swipeStart);
slider.addEventListener('mousedown', swipeStart);
home.addEventListener('click', function () {
  slideIndex = 0;
  slide();
});
next.addEventListener('click', function () {
  slideIndex = 1;
  slide();
}); // arrows.addEventListener('click', function() {
//   let target = event.target;
//   if (target.classList.contains('next')) {
//     slideIndex++;
//   } else if (target.classList.contains('prev')) {
//     slideIndex--;
//   } else {
//     return;
//   }
//   slide();
// });
// if (slideIndex === 1) {
//   console.log(slideIndex)
//   for (let i = 0; i < animation.length; i++) {
//     animation[i].classList.add('.appear');
//   };
// } else {
//   console.log(slideIndex)
//   for (let i = 0; i < animation.length; i++) {
//     animation[i].classList.remove('.appear');
//   };
// }
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNsaWRlci0xLmpzIl0sIm5hbWVzIjpbInNsaWRlciIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsInNsaWRlckxpc3QiLCJzbGlkZXJUcmFjayIsInNsaWRlcyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJob21lIiwibmV4dCIsInNsaWRlV2lkdGgiLCJvZmZzZXRXaWR0aCIsInNsaWRlSW5kZXgiLCJwb3NJbml0IiwicG9zWDEiLCJwb3NYMiIsInBvc1kxIiwicG9zWTIiLCJwb3NGaW5hbCIsImlzU3dpcGUiLCJpc1Njcm9sbCIsImFsbG93U3dpcGUiLCJ0cmFuc2l0aW9uIiwibmV4dFRyZiIsInByZXZUcmYiLCJsYXN0VHJmIiwibGVuZ3RoIiwicG9zVGhyZXNob2xkIiwidHJmUmVnRXhwIiwic3dpcGVTdGFydFRpbWUiLCJzd2lwZUVuZFRpbWUiLCJhbmltYXRpb24iLCJtb2RhbCIsImdldEV2ZW50IiwiZXZlbnQiLCJ0eXBlIiwic2VhcmNoIiwidG91Y2hlcyIsInNsaWRlIiwic3R5bGUiLCJ0cmFuc2Zvcm0iLCJpIiwiY2xhc3NMaXN0IiwiYWRkIiwicmVtb3ZlIiwic3dpcGVTdGFydCIsImV2dCIsIkRhdGUiLCJub3ciLCJjbGllbnRYIiwiY2xpZW50WSIsImFkZEV2ZW50TGlzdGVuZXIiLCJzd2lwZUFjdGlvbiIsInN3aXBlRW5kIiwibWF0Y2giLCJwb3NZIiwiTWF0aCIsImFicyIsInNldFRyYW5zZm9ybSIsInJlYWNoRWRnZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJjb21hcHJlVHJhbnNmb3JtIl0sIm1hcHBpbmdzIjoiOztBQUFBLElBQUlBLE1BQU0sR0FBR0MsUUFBUSxDQUFDQyxhQUFULENBQXVCLFNBQXZCLENBQWI7QUFBQSxJQUNFQyxVQUFVLEdBQUdILE1BQU0sQ0FBQ0UsYUFBUCxDQUFxQixlQUFyQixDQURmO0FBQUEsSUFFRUUsV0FBVyxHQUFHSixNQUFNLENBQUNFLGFBQVAsQ0FBcUIsZ0JBQXJCLENBRmhCO0FBQUEsSUFHRUcs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eEN2QyxFQUFBQSxVQUFVLEdBQUcsQ0FBYjtBQUNBMEIsRUFBQUEsS0FBSztBQUNOLENBSEQ7QUFLQTdCLElBQUksQ0FBQzBDLGdCQUFMLENBQXNCLE9BQXRCLEVBQStCLFlBQVc7QUFDeEN2QyxFQUFBQSxVQUFVLEdBQUcsQ0FBYjtBQUNBMEIsRUFBQUEsS0FBSztBQUNOLENBSEQsRSxDQUtBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlc0NvbnRlbnQiOlsibGV0IHNsaWRlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zbGlkZXInKSxcbiAgc2xpZGVyTGlzdCA9IHNsaWRlci5xdWVyeVNlbGVjdG9yKCcuc2xpZGVyX19saXN0JyksXG4gIHNsaWRlclRyYWNrID0gc2xpZGVyLnF1ZXJ5U2VsZWN0b3IoJy5zbGlkZXJfX3RyYWNrJyksXG4gIHNsaWRlcyA9IHNsaWRlci5xdWVyeVNlbGVjdG9yQWxsKCcuc2xpZGVyX19zbGlkZScpLFxuICBob21lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhlYWRlcl9fYnRuJyksXG4gIG5leHQgPSBzbGlkZXIucXVlcnlTZWxlY3RvcignLnNsaWRlLTFfX2J0bicpLFxuICBzbGlkZVdpZHRoID0gc2xpZGVzWzBdLm9mZnNldFdpZHRoLFxuICBzbGlkZUluZGV4ID0gMCxcbiAgcG9zSW5pdCA9IDAsXG4gIHBvc1gxID0gMCxcbiAgcG9zWDIgPSAwLFxuICBwb3NZMSA9IDAsXG4gIHBvc1kyID0gMCxcbiAgcG9zRmluYWwgPSAwLFxuICBpc1N3aXBlID0gZmFsc2UsXG4gIGlzU2Nyb2xsID0gZmFsc2UsXG4gIGFsbG93U3dpcGUgPSB0cnVlLFxuICB0cmFuc2l0aW9uID0gdHJ1ZSxcbiAgbmV4dFRyZiA9IDAsXG4gIHByZXZUcmYgPSAwLFxuICBsYXN0VHJmID0gLS1zbGlkZXMubGVuZ3RoICogc2xpZGVXaWR0aCxcbiAgcG9zVGhyZXNob2xkID0gc2xpZGVzWzBdLm9mZnNldFdpZHRoICogMC4zNSxcbiAgdHJmUmVnRXhwID0gLyhbLTAtOS5dKyg/PXB4KSkvLFxuICBzd2lwZVN0YXJ0VGltZSxcbiAgc3dpcGVFbmRUaW1lLFxuICBhbmltYXRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc2xpZGUtMl9faW1nJyk7XG4gIG1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsJyk7XG4gIGdldEV2ZW50ID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIChldmVudC50eXBlLnNlYXJjaCgndG91Y2gnKSAhPT0gLTEpID8gZXZlbnQudG91Y2hlc1swXSA6IGV2ZW50O1xuICB9LFxuICBzbGlkZSA9IGZ1bmN0aW9uKCkge1xuICAgIGlmICh0cmFuc2l0aW9uKSB7XG4gICAgICBzbGlkZXJUcmFjay5zdHlsZS50cmFuc2l0aW9uID0gJ3RyYW5zZm9ybSAuNXMnO1xuICAgIH1cbiAgICBzbGlkZXJUcmFjay5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlM2QoLSR7c2xpZGVJbmRleCAqIHNsaWRlV2lkdGh9cHgsIDBweCwgMHB4KWA7XG5cbiAgICBpZiAoc2xpZGVJbmRleCA9PT0gMSkge1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhbmltYXRpb24ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgYW5pbWF0aW9uW2ldLmNsYXNzTGlzdC5hZGQoJ2FwcGVhcicpO1xuICAgICAgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhbmltYXRpb24ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgYW5pbWF0aW9uW2ldLmNsYXNzTGlzdC5yZW1vdmUoJ2FwcGVhcicpO1xuICAgICAgfTtcbiAgICB9XG5cbiAgICBpZiAoc2xpZGVJbmRleCAhPT0gMikgbW9kYWwuc3R5bGUgPSAnZGlzcGxheTogbm9uZSdcbiAgICAvLyBwcmV2LmNsYXNzTGlzdC50b2dnbGUoJ2Rpc2FibGVkJywgc2xpZGVJbmRleCA9PT0gMCk7XG4gICAgLy8gbmV4dC5jbGFzc0xpc3QudG9nZ2xlKCdkaXNhYmxlZCcsIHNsaWRlSW5kZXggPT09IC0tc2xpZGVzLmxlbmd0aCk7XG4gIH0sXG4gIHN3aXBlU3RhcnQgPSBmdW5jdGlvbigpIHtcbiAgICBsZXQgZXZ0ID0gZ2V0RXZlbnQoKTtcblxuICAgIGlmIChhbGxvd1N3aXBlKSB7XG5cbiAgICAgIHN3aXBlU3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcblxuICAgICAgdHJhbnNpdGlvbiA9IHRydWU7XG5cbiAgICAgIG5leHRUcmYgPSAoc2xpZGVJbmRleCArIDEpICogLXNsaWRlV2lkdGg7XG4gICAgICBwcmV2VHJmID0gKHNsaWRlSW5kZXggLSAxKSAqIC1zbGlkZVdpZHRoO1xuXG4gICAgICBwb3NJbml0ID0gcG9zWDEgPSBldnQuY2xpZW50WDtcbiAgICAgIHBvc1kxID0gZXZ0LmNsaWVudFk7XG5cbiAgICAgIHNsaWRlclRyYWNrLnN0eWxlLnRyYW5zaXRpb24gPSAnJztcblxuICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2htb3ZlJywgc3dpcGVBY3Rpb24pO1xuICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgc3dpcGVBY3Rpb24pO1xuICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCBzd2lwZUVuZCk7XG4gICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgc3dpcGVFbmQpO1xuXG4gICAgICBzbGlkZXJMaXN0LmNsYXNzTGlzdC5yZW1vdmUoJ2dyYWInKTtcbiAgICAgIHNsaWRlckxpc3QuY2xhc3NMaXN0LmFkZCgnZ3JhYmJpbmcnKTtcbiAgICB9XG4gIH0sXG4gIHN3aXBlQWN0aW9uID0gZnVuY3Rpb24oKSB7XG5cbiAgICBsZXQgZXZ0ID0gZ2V0RXZlbnQoKSxcbiAgICAgIHN0eWxlID0gc2xpZGVyVHJhY2suc3R5bGUudHJhbnNmb3JtLFxuICAgICAgdHJhbnNmb3JtID0gK3N0eWxlLm1hdGNoKHRyZlJlZ0V4cClbMF07XG5cbiAgICBwb3NYMiA9IHBvc1gxIC0gZXZ0LmNsaWVudFg7XG4gICAgcG9zWDEgPSBldnQuY2xpZW50WDtcblxuICAgIHBvc1kyID0gcG9zWTEgLSBldnQuY2xpZW50WTtcbiAgICBwb3NZMSA9IGV2dC5jbGllbnRZO1xuXG4gICAgaWYgKCFpc1N3aXBlICYmICFpc1Njcm9sbCkge1xuICAgICAgbGV0IHBvc1kgPSBNYXRoLmFicyhwb3NZMik7XG4gICAgICBpZiAocG9zWSA+IDcgfHwgcG9zWDIgPT09IDApIHtcbiAgICAgICAgaXNTY3JvbGwgPSB0cnVlO1xuICAgICAgICBhbGxvd1N3aXBlID0gZmFsc2U7XG4gICAgICB9IGVsc2UgaWYgKHBvc1kgPCA3KSB7XG4gICAgICAgIGlzU3dpcGUgPSB0cnVlO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChpc1N3aXBlKSB7XG4gICAgICBpZiAoc2xpZGVJbmRleCA9PT0gMCkge1xuICAgICAgICBpZiAocG9zSW5pdCA8IHBvc1gxKSB7XG4gICAgICAgICAgc2V0VHJhbnNmb3JtKHRyYW5zZm9ybSwgMCk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGFsbG93U3dpcGUgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmIChzbGlkZUluZGV4ID09PSAtLXNsaWRlcy5sZW5ndGgpIHtcbiAgICAgICAgaWYgKHBvc0luaXQgPiBwb3NYMSkge1xuICAgICAgICAgIHNldFRyYW5zZm9ybSh0cmFuc2Zvcm0sIGxhc3RUcmYpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBhbGxvd1N3aXBlID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAocG9zSW5pdCA+IHBvc1gxICYmIHRyYW5zZm9ybSA8IG5leHRUcmYgfHwgcG9zSW5pdCA8IHBvc1gxICYmIHRyYW5zZm9ybSA+IHByZXZUcmYpIHtcbiAgICAgICAgcmVhY2hFZGdlKCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgc2xpZGVyVHJhY2suc3R5bGUudHJhbnNmb3JtID0gYHRyYW5zbGF0ZTNkKCR7dHJhbnNmb3JtIC0gcG9zWDJ9cHgsIDBweCwgMHB4KWA7XG4gICAgfVxuXG4gIH0sXG4gIHN3aXBlRW5kID0gZnVuY3Rpb24oKSB7XG4gICAgcG9zRmluYWwgPSBwb3NJbml0IC0gcG9zWDE7XG5cbiAgICBpc1Njcm9sbCA9IGZhbHNlO1xuICAgIGlzU3dpcGUgPSBmYWxzZTtcblxuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIHN3aXBlQWN0aW9uKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCBzd2lwZUFjdGlvbik7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCBzd2lwZUVuZCk7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIHN3aXBlRW5kKTtcblxuICAgIHNsaWRlckxpc3QuY2xhc3NMaXN0LmFkZCgnZ3JhYicpO1xuICAgIHNsaWRlckxpc3QuY2xhc3NMaXN0LnJlbW92ZSgnZ3JhYmJpbmcnKTtcblxuICAgIGlmIChhbGxvd1N3aXBlKSB7XG4gICAgICBzd2lwZUVuZFRpbWUgPSBEYXRlLm5vdygpO1xuICAgICAgaWYgKE1hdGguYWJzKHBvc0ZpbmFsKSA+IHBvc1RocmVzaG9sZCB8fCBzd2lwZUVuZFRpbWUgLSBzd2lwZVN0YXJ0VGltZSA8IDMwMCkge1xuICAgICAgICBpZiAocG9zSW5pdCA8IHBvc1gxKSB7XG4gICAgICAgICAgc2xpZGVJbmRleC0tO1xuICAgICAgICB9IGVsc2UgaWYgKHBvc0luaXQgPiBwb3NYMSkge1xuICAgICAgICAgIHNsaWRlSW5kZXgrKztcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBpZiAoc2xpZGVJbmRleCA9PT0gMSlcblxuICAgICAgaWYgKHBvc0luaXQgIT09IHBvc1gxKSB7XG4gICAgICAgIGFsbG93U3dpcGUgPSBmYWxzZTtcbiAgICAgICAgc2xpZGUoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGFsbG93U3dpcGUgPSB0cnVlO1xuICAgICAgfVxuXG4gICAgfSBlbHNlIHtcbiAgICAgIGFsbG93U3dpcGUgPSB0cnVlO1xuICAgIH1cblxuICB9LFxuICBzZXRUcmFuc2Zvcm0gPSBmdW5jdGlvbih0cmFuc2Zvcm0sIGNvbWFwcmVUcmFuc2Zvcm0pIHtcbiAgICBpZiAodHJhbnNmb3JtID49IGNvbWFwcmVUcmFuc2Zvcm0pIHtcbiAgICAgIGlmICh0cmFuc2Zvcm0gPiBjb21hcHJlVHJhbnNmb3JtKSB7XG4gICAgICAgIHNsaWRlclRyYWNrLnN0eWxlLnRyYW5zZm9ybSA9IGB0cmFuc2xhdGUzZCgke2NvbWFwcmVUcmFuc2Zvcm19cHgsIDBweCwgMHB4KWA7XG4gICAgICB9XG4gICAgfVxuICAgIGFsbG93U3dpcGUgPSBmYWxzZTtcbiAgfSxcbiAgcmVhY2hFZGdlID0gZnVuY3Rpb24oKSB7XG4gICAgdHJhbnNpdGlvbiA9IGZhbHNlO1xuICAgIHN3aXBlRW5kKCk7XG4gICAgYWxsb3dTd2lwZSA9IHRydWU7XG4gIH07XG5cbnNsaWRlclRyYWNrLnN0eWxlLnRyYW5zZm9ybSA9ICd0cmFuc2xhdGUzZCgwcHgsIDBweCwgMHB4KSc7XG5zbGlkZXJMaXN0LmNsYXNzTGlzdC5hZGQoJ2dyYWInKTtcblxuc2xpZGVyVHJhY2suYWRkRXZlbnRMaXN0ZW5lcigndHJhbnNpdGlvbmVuZCcsICgpID0+IGFsbG93U3dpcGUgPSB0cnVlKTtcbnNsaWRlci5hZGRFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0Jywgc3dpcGVTdGFydCk7XG5zbGlkZXIuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgc3dpcGVTdGFydCk7XG5cbmhvbWUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbigpIHtcbiAgc2xpZGVJbmRleCA9IDA7XG4gIHNsaWRlKCk7XG59KTtcblxubmV4dC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuICBzbGlkZUluZGV4ID0gMTtcbiAgc2xpZGUoKTtcbn0pXG5cbi8vIGFycm93cy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuLy8gICBsZXQgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0O1xuXG4vLyAgIGlmICh0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCduZXh0JykpIHtcbi8vICAgICBzbGlkZUluZGV4Kys7XG4vLyAgIH0gZWxzZSBpZiAodGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygncHJldicpKSB7XG4vLyAgICAgc2xpZGVJbmRleC0tO1xuLy8gICB9IGVsc2Uge1xuLy8gICAgIHJldHVybjtcbi8vICAgfVxuXG4vLyAgIHNsaWRlKCk7XG4vLyB9KTtcblxuXG4vLyBpZiAoc2xpZGVJbmRleCA9PT0gMSkge1xuLy8gICBjb25zb2xlLmxvZyhzbGlkZUluZGV4KVxuLy8gICBmb3IgKGxldCBpID0gMDsgaSA8IGFuaW1hdGlvbi5sZW5ndGg7IGkrKykge1xuLy8gICAgIGFuaW1hdGlvbltpXS5jbGFzc0xpc3QuYWRkKCcuYXBwZWFyJyk7XG4vLyAgIH07XG4vLyB9IGVsc2Uge1xuLy8gICBjb25zb2xlLmxvZyhzbGlkZUluZGV4KVxuLy8gICBmb3IgKGxldCBpID0gMDsgaSA8IGFuaW1hdGlvbi5sZW5ndGg7IGkrKykge1xuLy8gICAgIGFuaW1hdGlvbltpXS5jbGFzc0xpc3QucmVtb3ZlKCcuYXBwZWFyJyk7XG4vLyAgIH07XG4vLyB9XG5cbiJdLCJmaWxlIjoic2xpZGVyLTEuanMifQ==
